{% with id=widget.attrs.id %}<div id="{% if id %}{{ id }}_div{% endif %}" class="input-field" style="{% if inline %}display: inline-block; min-width: 200px;{% endif %}{{ style }}">
    <input type="text" name=""{% if widget.value.0 != None %} value="{{ widget.value.0|stringformat:'s' }}"{% endif %}
       id="{{ id }}_inp" autocomplete="off"
       {% if widget.attrs.hidden %}hidden{% endif %}
       {% if widget.attrs.placeholder %}placeholder="{{ widget.attrs.placeholder }}"{% endif %}
       {% if widget.attrs.max_length %}maxLength={{ widget.attrs.max_length }}{% endif %}
       class="{{ widget.attrs.class }}" style="{{ widget.attrs.style }}">
    <input id="{{ id }}" name="{{ widget.name }}"{% if widget.value.0 != None %} value="{{ widget.value.0|stringformat:'s' }}"{% endif %} hidden>
    <span class="helper-text" data-error="{% for err in field.errors %}{{ err }}{% if not forloop.last %}, {% endif %}{% endfor %}"></span>

    <script>
        // When the document is loaded populate all of the options for the autocomplete box.
        $(window).on('load', function() {
            // Set variables
            set_auto_field('#{{ id }}_inp', 'auto_data', {});
            set_auto_field('#{{ id }}_inp', 'auto_data_li', {});
            set_auto_field('#{{ id }}_inp', 'search_request', null);

            // Create the auto complete object
            var auto_inst = M.Autocomplete.init($('#{{ id }}_inp')[0], {
                'data': get_auto_data('#{{ id }}_inp'),
                'limit': 10,

                onAutocomplete: function(val){
                    $('#{{ id }}_inp').value = val;
                    var value = get_auto_data_val('#{{ id }}_inp', val);
                    if(value != null) {
                        $('#{{ id }}')[0].value = value;
                    }
                }
            });
            set_auto_field('#{{ id }}_inp', 'auto_inst', auto_inst);

            // Populate the data
            try{
                var data = JSON.parse('{{ widget.options }}');
                if(data){
                    populate_autocomplete('#{{ id }}_inp', data);
                } else {
                    request_autocomplete('#{{ id }}_inp', "{{ widget.url }}");
                }
            }catch (exc) {
                request_autocomplete('#{{ id }}_inp', "{{ widget.url }}");
            }

            // If query_name given reset auto complete options when text is entered.
            if("{{ widget.query_name }}" !== ""){
                $('#{{ id }}_inp').on('input', function(e){
                    request_autocomplete('#{{ id }}_inp', "{{ widget.url }}", "{{ widget.query_name }}");
                });
            }
        });
    </script>
</div>{% endwith %}
